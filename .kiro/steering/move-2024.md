# Move 2024 Edition - Sui Development Guide

This steering file provides guidance for writing Move smart contracts using the 2024 edition for Sui blockchain.

## Edition Configuration

Specify edition in `Move.toml`:
```toml
edition = "2024.beta"
```

## Key Syntax Changes (Move 2024)

### 1. Mutable Bindings with `let mut`

Always use `let mut` for mutable variables:
```move
// Correct
let mut x = 5;
x = 10;

// Also for function parameters
public fun process(mut value: u64): u64 {
    value = value + 1;
    value
}

// Tuple destructuring
let (mut a, b) = (1, 2);
```

### 2. Struct Visibility

Structs require explicit visibility modifier:
```move
// Public struct
public struct MyStruct has key, store {
    id: UID,
    value: u64,
}
```

### 3. Function Visibility - `public(package)` replaces `friend`

The `friend` keyword is deprecated. Use `public(package)` instead:
```move
// Old (deprecated)
// friend some_module;
// public(friend) fun internal_fn() {}

// New (Move 2024)
public(package) fun internal_fn() {}
```

### 4. Method Syntax

Functions with struct as first argument can use dot notation:
```move
public struct Counter has key {
    id: UID,
    value: u64,
}

public fun increment(self: &mut Counter) {
    self.value = self.value + 1;
}

// Can be called as:
// counter.increment();
```

### 5. Borrowing Operator `[]`

Built-in types support index access:
```move
let v = vector[1, 2, 3];
let first = &v[0];  // Borrow element at index 0
```

Custom types can implement with `#[syntax(index)]` attribute.

## Sui-Specific Patterns

### Object Creation
```move
public fun new(ctx: &mut TxContext): MyObject {
    MyObject {
        id: object::new(ctx),
        // fields...
    }
}
```

### Transfer Patterns
```move
// Transferable objects (has key + store)
transfer::public_transfer(obj, recipient);

// Non-transferable/soulbound (has key only, no store)
transfer::transfer(obj, recipient);

// Shared objects
transfer::share_object(obj);

// Immutable objects
transfer::public_freeze_object(obj);
```

### Events
```move
use sui::event;

public struct MyEvent has copy, drop {
    data: u64,
}

event::emit(MyEvent { data: 42 });
```

### Error Handling
```move
const EInvalidInput: u64 = 0;
const EUnauthorized: u64 = 1;

assert!(condition, EInvalidInput);
```

## Testing Patterns

```move
#[test_only]
module mypackage::tests;

use sui::test_scenario::{Self as ts, Scenario};

#[test]
fun test_something() {
    let mut scenario = ts::begin(@0x1);
    // test logic
    ts::end(scenario);
}

#[test]
#[expected_failure(abort_code = ::mypackage::mymodule::EErrorCode)]
fun test_failure_case() {
    // code that should abort
}
```

## Migration Tool

Run migration from old Move to 2024 edition:
```bash
sui move migrate
```

This updates:
- `let` to `let mut` where needed
- Adds `public` modifier to structs
- Converts `friend` + `public(friend)` to `public(package)`

## Common Imports

```move
use sui::object::{Self, UID};
use sui::transfer;
use sui::tx_context::{Self, TxContext};
use sui::event;
use sui::coin::{Self, Coin};
use sui::balance::{Self, Balance};
use sui::table::{Self, Table};
use sui::vec_map::{Self, VecMap};
```

## File Patterns

- Source files: `sources/*.move`
- Test files: `tests/*_tests.move`
- Use `#[test_only]` for test-only modules and functions
